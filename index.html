<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>traversability_generator3d: traversability_generator3d</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">traversability_generator3d
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespacetraversability__generator3d.html">traversability_generator3d</a> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> CI build (paper): <img src="https://github.com/dfki-ric/traversability_generator3d/actions/workflows/c-cpp.yml/badge.svg" alt="paper" style="pointer-events: none;" class="inline"/></p>
<p>JOSS Paper: <a href="https://doi.org/10.21105/joss.09410"><img src="https://joss.theoj.org/papers/10.21105/joss.09410/status.svg" alt="DOI" style="pointer-events: none;" class="inline"/></a></p>
<p>[<img src="https://img.shields.io/badge/License-BSD%203--Clause-blue.svg" alt="License: BSD-3-Clause" style="pointer-events: none;" class="inline"/>](LICENSE)</p>
<p>A C++ library for <b>3D traversability estimation from Multi-Level Surface (MLS) maps</b>, developed at the <a href="https://robotik.dfki-bremen.de/en/startpage.html">DFKI Robotics Innovation Center</a>.</p>
<p>The library takes an MLS map as input and produces a <code>TraversabilityMap3d</code> enriched with slope, step height, orientation constraints, and soil semantics. This enables safe and robot-specific navigation in unstructured outdoor environments.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Features</h1>
<ul>
<li>Input: <b>Multi-Level Surface (MLS) maps</b> <br  />
</li>
<li>Plane fitting with <b>PCL RANSAC</b> <br  />
</li>
<li>Slope and step height checks using <b>AABB/OBB</b> methods with <b>CGAL</b></li>
<li>Orientation-dependent motion constraints (incline limiting) <br  />
</li>
<li>Robot footprint-aware <b>obstacle and frontier inflation</b> <br  />
</li>
<li><b>Soil-aware traversability</b> (sand, gravel, rocks, concrete) with uncertainty propagation <br  />
</li>
<li>ROS/ROS2 compatibility and RViz visualization support <br  />
</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Dependencies</h1>
<ul>
<li><a href="https://eigen.tuxfamily.org/">Eigen3</a> <br  />
</li>
<li><a href="https://pointclouds.org/">PCL (&gt;=1.7)</a> with segmentation module <br  />
</li>
<li><a href="https://www.cgal.org/">CGAL</a> (Core) <br  />
</li>
<li><a href="https://www.boost.org/">Boost.Serialization</a> <br  />
</li>
<li><a href="http://www.openscenegraph.org/">OpenSceneGraph</a></li>
<li><a href="https://github.com/rock-core/base-types">Rock base-types</a> <br  />
</li>
<li><a href="https://github.com/dfki-ric/slam-maps">Rock maps</a> <br  />
</li>
<li><a href="https://github.com/rock-gui/gui-vizkit3d_debug_drawings.git">vizkit3d_debug_drawings</a> (optional, for visualization) <br  />
</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Automatic Install of Dependencies &amp; Build</h1>
<p>Install dependencies automatically when building <a class="el" href="namespacetraversability__generator3d.html">traversability_generator3d</a>. Defining <code>-DINSTALL_DEPS=ON</code> for cmake, builds and installs the source dependencies automatically. When <code>-DCMAKE_INSTALL_PREFIX</code> is used, the dependencies are also installed there. The install script generates an env.sh file in the <code>CMAKE_INSTALL_PREFIX</code> folder. It exports all neccessary environment variables.</p>
<div class="fragment"><div class="line">git clone https://github.com/dfki-ric/traversability_generator3d.git -b paper</div>
<div class="line">cd traversability_generator3d</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake -DINSTALL_DEPS=ON -DRUN_TESTS=ON -DCMAKE_INSTALL_PREFIX=./install ..</div>
<div class="line">make install</div>
<div class="line">source install/env.sh</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Node types</h1>
<p>The core output of <code><a class="el" href="namespacetraversability__generator3d.html">traversability_generator3d</a></code> is a <code>TraversabilityMap3d</code>, where each cell is represented as a node enriched with slope, step height, soil information, etc. <br  />
 To support planning and decision-making, nodes are classified into the following categories:</p>
<ul>
<li>üü© <b>Traversable</b>: The robot can stand (with its center) on this patch in at least one orientation without hitting an obstacle.</li>
<li>üü• <b>Obstacle</b>: There is no way that the robot can stand (with its center) on this patch.</li>
<li>üü¶ <b>Frontier</b>: Borders to the end of the map. Should be traversable (I am not 100% sure about this. check the code!)</li>
<li>üü™ <b>Unknown</b>: This is a virtual patch that serves as boundary for algorithms. This patch does not exist in reality. Patches also become unknown if there is not enough support in the MLS to be sure that a patch exists in this location.</li>
<li>‚¨õ <b>Hole</b>: This is part of the map specification but is not used by <a class="el" href="namespacetraversability__generator3d.html">traversability_generator3d</a>.</li>
<li>üü® <b>Unset</b>: This is the starting state of a new patch. It should not be visible in a fully explored map. If you see a yellow patch after map expansion is done, you have found a bug in the <code>TraversabilityMapGenerator</code> and should investigate.</li>
<li>üüß <b>Inflated Obstacle</b>: An obstacle patch expanded to include a safety buffer around the actual obstacle. These are not traversable.</li>
<li><img src="https://github.com/user-attachments/assets/775162ac-be4c-4a32-a24b-8ab41f5cea99" alt="image" width="28" height="28" style="border: none;" class="inline"/><b>Inflated Frontier</b>: A frontier patch that has been inflated for planning safety margins. Indicates proximity to exploration boundaries.</li>
</ul>
<p><img src="utah.png" alt="Utah Environment" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md5"></a>
Why node types matter</h2>
<p>This rich classification scheme provides more than just a binary safe/unsafe map. It enables planners to: <br  />
</p><ul>
<li>Prioritize safe traversal while accounting for soil costs. <br  />
</li>
<li>Use <b>frontier nodes</b> to guide exploration and map growth. <br  />
</li>
<li>Maintain safety margins by considering <b>inflated nodes</b>. <br  />
</li>
</ul>
<p>Together, these node types form the backbone of the <code>TraversabilityMap3d</code>, making it both a <b>planning tool</b> and a <b>research framework</b> for robust traversability estimation.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Soil-Aware Traversability</h1>
<p>Traversability estimation can optionally incorporate <b>semantic soil information</b> that influences traversal costs and feasibility.</p>
<p>Supported soil types:</p><ul>
<li><b>Concrete</b></li>
<li><b>Rocks</b></li>
<li><b>Sand</b></li>
<li><b>Gravel</b></li>
<li><b>Unknown / Unlabeled</b></li>
</ul>
<p>Each soil sample is modeled as a <b>Gaussian distribution</b> over the map with configurable parameters:</p><ul>
<li><code>sigmaX</code>, <code>sigmaY</code> ‚Äì spatial influence (spread)</li>
<li><code>uncertainty ‚àà [0,1]</code> ‚Äì confidence of the soil label</li>
</ul>
<p>This allows <b>soft, probabilistic integration</b> of sparse soil observations into the traversability map.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md8"></a>
Interactive GUI</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
GUI Controls</h2>
<p>Below the visualization window, the GUI provides:</p>
<ul>
<li><b>Soil type dropdown</b><ul>
<li><code>No selection</code> (default)</li>
<li><code>CONCRETE</code></li>
<li><code>ROCKS</code></li>
<li><code>SAND</code></li>
<li><code>GRAVEL</code></li>
</ul>
</li>
<li><b>œÉx, œÉy spin boxes</b><ul>
<li>Control the Gaussian spread of the soil sample</li>
</ul>
</li>
<li><b>Uncertainty spin box</b><ul>
<li>Confidence of the soil label in the range <code>[0, 1]</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
Interaction Logic</h2>
<ul>
<li><b>Left-click on MLS Map with ‚ÄúNo selection‚Äù</b><ul>
<li>Sets the <b>start pose</b></li>
<li>Triggers traversability expansion</li>
</ul>
</li>
<li><b>Left-click on MLS Map with a soil type selected</b><ul>
<li>Sets the <b>start pose</b></li>
<li>Adds a <b>SoilSample</b> at the clicked location</li>
<li>Triggers traversability expansion</li>
<li>Soil influence is applied on the traversability expansion</li>
</ul>
</li>
<li><b>Left-Click on button Reset Traversability and Soil Maps</b><ul>
<li>Resets the data structures for traversability and soil map.</li>
</ul>
</li>
</ul>
<p>This interaction model ensures a <b>clear separation</b> between navigation setup and environment annotation.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Run Example with Test Data</h1>
<p>You can quickly verify the setup by downloading and running the provided test datasets. <br  />
</p>
<h2><a class="anchor" id="autotoc_md12"></a>
1. Download the sample point clouds</h2>
<div class="fragment"><div class="line">wget https://zenodo.org/records/13771864/files/utah.ply</div>
<div class="line">wget https://zenodo.org/records/13771864/files/test_area.ply</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md13"></a>
2. Run the traversability generator</h2>
<div class="fragment"><div class="line">./build/gui/traversability_generator3d_bin-qt5 utah.ply 0.3</div>
<div class="line">./build/gui/traversability_generator3d_bin-qt5 test_area.ply 0.2</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>&zwj;üí° <b>Tip:</b> The following enviroment variables can be used to control the behaviour of the logger: <b>BASE_LOG_LEVEL</b> Set to one of DEBUG, INFO, WARN, ERROR or FATAL to define the maximum logging level. </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md14"></a>
3. Inspect the results in the GUI</h2>
<ul>
<li>After the GUI loads, <b>left-click on the MLS map</b>. <br  />
</li>
<li>The corresponding <b>TraversabilityMap3d</b> will expand and display navigable vs. non-navigable regions. <br  />
</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;üí° <b>Tip:</b> The second argument (<code>0.3</code> or <code>0.2</code>) specifies the resolution in meters, which controls the grid size for the MLS and traversability map. </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md15"></a>
4. Code Walkthrough</h2>
<p>A minimal executable is provided to demonstrate the full traversability generation pipeline on a real 3D point cloud. The walkthrough loads a point cloud, builds the MLS map, and computes the traversability and frontier regions.</p>
<blockquote class="doxtable">
<p>&zwj;üí° <b>Tip:</b> The start position is assumed to be at <code>(0, 0, -distToGround)</code>. <br  />
 If your point cloud is offset or uses a different coordinate frame, update the start position accordingly to ensure expansion begins on the ground surface. </p>
</blockquote>
<p>Run the walkthrough using: </p><div class="fragment"><div class="line">./build/test/travgen3d_walkthrough utah.ply</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
5. Tests</h2>
<p>The traversability generator is validated using unit tests. The tests cover core functionality such as:</p>
<ul>
<li>Traversability map generation from MLS input</li>
<li>Step-height handling and obstacle detection</li>
<li>Frontier detection and frontier inflation</li>
</ul>
<p>To build and run the test suite:</p>
<div class="fragment"><div class="line">./build/test/test_TraversabilityGenerator3d</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17"></a>
Acknowledgements</h1>
<p>This library was developed at the <a href="https://robotik.dfki-bremen.de/en/startpage.html">DFKI Robotics Innovation Center</a> and funded by the <b>German Federal Ministry of Education and Research (BMBF)</b>. <br  />
</p>
<h1><a class="anchor" id="autotoc_md18"></a>
License</h1>
<p>This project is released under the [BSD-3-Clause License](LICENSE). </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
